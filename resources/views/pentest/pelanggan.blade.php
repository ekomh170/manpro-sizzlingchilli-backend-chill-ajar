<!-- resources/views/pentest/pelanggan.blade.php -->
@include('pentest._template', [
    'title' => 'Pentest API - Pelanggan Controller',
    'apiList' => [
        [
            'label' => 'Profil Saya',
            'method' => 'GET',
            'url' => '/api/pelanggan/profil-saya',
        ],
        [
            'label' => 'Daftar Kursus',
            'method' => 'GET',
            'url' => '/api/pelanggan/daftar-kursus',
        ],
        [
            'label' => 'Cari Mentor (by namaKursus)',
            'method' => 'GET',
            'url' => '/api/pelanggan/cari-mentor?namaKursus=',
        ],
        [
            'label' => 'Daftar Sesi',
            'method' => 'GET',
            'url' => '/api/pelanggan/daftar-sesi',
        ],
        [
            'label' => 'Detail Mentor',
            'method' => 'GET',
            'url' => '/api/pelanggan/detail-mentor/{mentorId}',
        ],
        [
            'label' => 'Pesan Sesi (otomatis buat transaksi)',
            'method' => 'POST',
            'url' => '/api/pelanggan/pesan-sesi',
            'body' => [
                'mentor_id' => '',
                'pelanggan_id' => '',
                'kursus_id' => '',
                'jadwal_kursus_id' => '',
                'detailKursus' => '',
                // Field pembayaran diaktifkan sesuai validasi controller
                'metodePembayaran' => '', // wajib (string)
                'tanggalPembayaran' => '', // wajib (date)
                'buktiPembayaran' => '', // wajib file (jpg, jpeg, png, pdf, max 5MB)
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Akan otomatis membuat entri transaksi pembayaran terkait sesi yang dipesan.<br>Field <b>mentor_id</b>, <b>pelanggan_id</b>, <b>kursus_id</b>, <b>jadwal_kursus_id</b>, <b>metodePembayaran</b>, <b>tanggalPembayaran</b>, dan <b>buktiPembayaran</b> <b>wajib diisi</b>.<br>Bukti pembayaran harus berupa file (jpg, jpeg, png, pdf, max 5MB).</span>',
        ],
        [
            'label' => 'Unggah Bukti Pembayaran',
            'method' => 'POST',
            'url' => '/api/pelanggan/unggah-bukti/{transaksiId}',
            'body' => [
                'buktiPembayaran' => '',
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
        ],
        [
            'label' => 'Beri Testimoni',
            'method' => 'POST',
            'url' => '/api/pelanggan/beri-testimoni/{sessionId}',
            'body' => [
                'rating' => '', // wajib (1-5)
                'komentar' => '', // opsional
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Hanya bisa digunakan jika:<br>- Sesi milik pelanggan login<br>- Status sesi sudah <b>selesai</b><br>- Belum pernah memberi testimoni untuk sesi ini.<br>Field <b>rating</b> wajib (1-5), <b>komentar</b> opsional.</span>',
        ],
        [
            'label' => 'Lihat Semua Transaksi (relasi lengkap)',
            'method' => 'GET',
            'url' => '/api/transaksi',
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Menampilkan semua transaksi beserta relasi pelanggan.user, mentor.user, dan sesi.kursus.</span>',
        ],
        [
            'label' => 'Detail Transaksi',
            'method' => 'GET',
            'url' => '/api/transaksi/{id}',
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Menampilkan detail transaksi beserta relasi pelanggan, mentor, dan sesi.</span>',
        ],
        [
            'label' => 'Unggah Ulang Bukti Pembayaran (Jika Ditolak)',
            'method' => 'POST',
            'url' => '/api/pelanggan/unggah-ulang-bukti/{transaksiId}',
            'body' => [
                'buktiPembayaran' => '', // wajib file
                'tanggalPembayaran' => '', // wajib date
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Hanya bisa digunakan jika status pembayaran <b>ditolak</b>.<br>Bukti pembayaran wajib file (jpg, jpeg, png, pdf, max 5MB).<br>Tanggal pembayaran akan diperbarui sesuai unggahan terakhir.</span>',
        ],
    ],
])

<script>
    function setExampleBody(example) {
        document.getElementById('body').value = example.body === null ? '' : JSON.stringify(example.body, null, 2);
        if (example.headers) {
            document.getElementById('headers').value = JSON.stringify(example.headers, null, 2);
        }
        if (example.url) {
            document.getElementById('url').value = example.url;
        }
        if (example.method) {
            document.getElementById('method').value = example.method;
        }
        if (example.noteHtml) {
            document.getElementById('api-note').innerHTML = example.noteHtml;
        }
    }

    function setExampleProfilSaya() {
        setExampleBody({
            body: null,
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/profil-saya',
            method: 'GET',
            noteHtml: '<span class="text-xs text-amber-700">Lihat profil pelanggan login (Arby).</span>'
        });
    }

    function setExampleDaftarKursus() {
        setExampleBody({
            body: null,
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/daftar-kursus',
            method: 'GET',
            noteHtml: '<span class="text-xs text-amber-700">Lihat daftar kursus yang tersedia.</span>'
        });
    }

    function setExampleCariMentor() {
        setExampleBody({
            body: null,
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/cari-mentor?namaKursus=MANAJEMEN PROYEK',
            method: 'GET',
            noteHtml: '<span class="text-xs text-amber-700">Cari mentor berdasarkan nama kursus (contoh: MANAJEMEN PROYEK).</span>'
        });
    }

    function setExampleDaftarSesi() {
        setExampleBody({
            body: null,
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/daftar-sesi',
            method: 'GET',
            noteHtml: '<span class="text-xs text-amber-700">Lihat daftar sesi yang pernah diikuti pelanggan login.</span>'
        });
    }

    function setExampleDetailMentor() {
        setExampleBody({
            body: null,
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/detail-mentor/3', // contoh mentorId=3 (Fatiya)
            method: 'GET',
            noteHtml: '<span class="text-xs text-amber-700">Lihat detail mentor Fatiya (mentorId=3). Ganti id sesuai data Anda.</span>'
        });
    }

    function setExamplePesanSesiArby() {
        setExampleBody({
            body: {
                mentor_id: 3, // id mentor Fatiya
                pelanggan_id: 6, // id Arby dari seeder
                kursus_id: 1, // contoh id kursus
                jadwal_kursus_id: 1, // contoh id jadwal kursus
                detailKursus: 'Belajar privat',
                metodePembayaran: 'manual',
                tanggalPembayaran: '2025-06-02',
                buktiPembayaran: 'bukti_dummy.jpg'
            },
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/pesan-sesi',
            method: 'POST',
            noteHtml: '<span class=\'text-xs text-amber-700\'>Contoh pemesanan sesi oleh pelanggan Arby (id=6, email=arby@demo.com) ke mentor Fatiya (id=3). Silakan sesuaikan id kursus/jadwal sesuai data Anda.<br>Field pembayaran wajib diisi dan file harus sesuai format.</span>'
        });
    }

    function setExampleUnggahBukti() {
        setExampleBody({
            body: {
                buktiPembayaran: 'bukti_dummy.jpg'
            },
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/unggah-bukti/1', // contoh transaksiId=1
            method: 'POST',
            noteHtml: '<span class="text-xs text-amber-700">Contoh unggah bukti pembayaran untuk transaksiId=1. Ganti id sesuai data Anda.</span>'
        });
    }

    function setExampleBeriTestimoni() {
        setExampleBody({
            body: {
                rating: 5, // contoh rating
                komentar: 'Mentor sangat membantu dan ramah.'
            },
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/beri-testimoni/1', // contoh sessionId=1
            method: 'POST',
            noteHtml: '<span class="text-xs text-amber-700">Contoh testimoni untuk sessionId=1.<br>Hanya bisa digunakan jika:<br>- Sesi milik pelanggan login<br>- Status sesi sudah <b>selesai</b><br>- Belum pernah memberi testimoni untuk sesi ini.<br>Field <b>rating</b> wajib (1-5), <b>komentar</b> opsional.<br>Ganti id sesuai data Anda.</span>'
        });
    }

    function setExampleUnggahUlangBukti() {
        setExampleBody({
            body: {
                buktiPembayaran: 'bukti_ulang_dummy.jpg',
                tanggalPembayaran: '2025-06-02',
            },
            headers: {
                Authorization: 'Bearer <token>'
            },
            url: '/api/pelanggan/unggah-ulang-bukti/1', // contoh transaksiId=1
            method: 'POST',
            noteHtml: '<span class="text-xs text-amber-700">Contoh unggah ulang bukti pembayaran untuk transaksiId=1 jika pembayaran ditolak. Ganti id sesuai data Anda.</span>'
        });
    }
</script>

<div class="mb-4">
    <label class="font-semibold text-amber-700">Example Testing:</label>
    <div class="flex flex-wrap gap-2 mt-2">
        <button type="button" onclick="setExampleProfilSaya()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Profil
            Saya</button>
        <button type="button" onclick="setExampleDaftarKursus()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Daftar
            Kursus</button>
        <button type="button" onclick="setExampleCariMentor()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Cari Mentor
            (by namaKursus)</button>
        <button type="button" onclick="setExampleDaftarSesi()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Daftar
            Sesi</button>
        <button type="button" onclick="setExampleDetailMentor()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Detail
            Mentor</button>
        <button type="button" onclick="setExamplePesanSesiArby()"
            class="bg-amber-200 hover:bg-amber-300 text-amber-900 font-semibold px-3 py-1 rounded shadow">Pesan Sesi
            (Arby ke Fatiya)</button>
        <button type="button" onclick="setExampleUnggahBukti()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Unggah Bukti
            Pembayaran (Dummy)</button>
        <button type="button" onclick="setExampleBeriTestimoni()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Beri Testimoni
            (Arby ke Fatiya)</button>
        <button type="button" onclick="setExampleUnggahUlangBukti()"
            class="bg-amber-100 hover:bg-amber-200 text-amber-900 font-semibold px-3 py-1 rounded shadow">Unggah Ulang
            Bukti
            Pembayaran (Jika Ditolak)</button>
    </div>
</div>

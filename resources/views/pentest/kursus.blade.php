<!-- resources/views/pentest/kursus.blade.php -->
@include('pentest._template', [
    'title' => 'Pentest API - Kursus Controller',
    'apiList' => [
        [
            'label' => 'Daftar Kursus',
            'method' => 'GET',
            'url' => '/api/kursus',
            'noteHtml' =>
                '<span class="text-xs text-amber-700"><b>⭐ Include Relasi:</b> visibilitasPaket.paket.items - Setiap kursus tampil dengan paket dan item yang aktif.</span>',
        ],
        [
            'label' => 'Detail Kursus',
            'method' => 'GET',
            'url' => '/api/kursus/{id}',
        ],
        [
            'label' => 'Tambah Kursus',
            'method' => 'POST',
            'url' => '/api/kursus',
            'body' => [
                'namaKursus' => '',
                'deskripsi' => '',
                'mentor_id' => '',
                'fotoKursus' => '', // file upload
                'paket_ids' => [], // ⭐ WAJIB minimal 1 paket
                'visibilitas_paket' => [], // ⭐ OPTIONAL: [{"paket_id": 1, "visibilitas": true}]
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700"><b>⭐ PAKET REQUIRED:</b> Field <b>paket_ids</b> WAJIB diisi minimal 1 paket (array). Contoh: [1, 2, 3].<br><b>visibilitas_paket</b> opsional untuk set status visible tiap paket. Contoh: [{"paket_id": 1, "visibilitas": true}, {"paket_id": 2, "visibilitas": false}].<br>Untuk upload foto, gunakan form-data dengan key <b>fotoKursus</b> (max 10MB).</span>',
        ],
        [
            'label' => 'Update Kursus',
            'method' => 'PUT',
            'url' => '/api/kursus/{id}',
            'body' => [
                'namaKursus' => '',
                'deskripsi' => '',
                'mentor_id' => '',
                'fotoKursus' => '', // file upload (optional)
                'paket_ids' => [], // ⭐ OPTIONAL: update paket yang aktif
                'visibilitas_paket' => [], // ⭐ FIX BUG: updateOrCreate - bisa tambah paket baru walaupun awalnya cuma 1
            ],
            'headers' => [
                'Authorization' => 'Bearer {token}',
                'Content-Type' => 'multipart/form-data',
            ],
            'noteHtml' =>
                '<span class="text-xs text-amber-700"><b>⭐ BUG FIX (Higa):</b> Sekarang bisa tambah paket baru di form edit walaupun saat create hanya aktifkan 1 paket. Menggunakan <b>updateOrCreate</b> untuk memastikan entry selalu ada.<br><b>paket_ids</b>: Update semua paket aktif (hapus lama, tambah baru).<br><b>visibilitas_paket</b>: Toggle status visible tiap paket. Contoh: [{"paket_id": 1, "visibilitas": true}, {"paket_id": 2, "visibilitas": false}].<br>Untuk update foto, gunakan form-data dengan key <b>fotoKursus</b>.</span>',
        ],
        [
            'label' => 'Hapus Kursus',
            'method' => 'DELETE',
            'url' => '/api/kursus/{id}',
            'headers' => ['Authorization' => 'Bearer {token}'],
        ],
        [
            'label' => 'Daftar Jadwal Kursus',
            'method' => 'GET',
            'url' => '/api/jadwal-kursus',
        ],
        [
            'label' => 'Detail Jadwal Kursus',
            'method' => 'GET',
            'url' => '/api/jadwal-kursus/{id}',
        ],
        [
            'label' => 'Tambah Jadwal Kursus',
            'method' => 'POST',
            'url' => '/api/jadwal-kursus',
            'body' => [
                'kursus_id' => '',
                'tanggal' => '',
                'waktu' => '',
                'keterangan' => '',
                'tempat' => '', // Tambahan field tempat
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
        ],
        [
            'label' => 'Update Jadwal Kursus',
            'method' => 'PUT',
            'url' => '/api/jadwal-kursus/{id}',
            'body' => [
                'kursus_id' => '',
                'tanggal' => '',
                'waktu' => '',
                'keterangan' => '',
                'tempat' => '', // Tambahan field tempat
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
        ],
        [
            'label' => 'Hapus Jadwal Kursus',
            'method' => 'DELETE',
            'url' => '/api/jadwal-kursus/{id}',
            'headers' => ['Authorization' => 'Bearer {token}'],
        ],
        [
            'label' => 'Daftar Kursus (Public, dengan relasi mentor.user)',
            'method' => 'GET',
            'url' => '/api/public/kursus',
            'noteHtml' =>
                '<span class="text-xs text-amber-700"><b>⭐ FILTER JADWAL:</b> Endpoint public. Menampilkan semua kursus beserta relasi mentor dan user (tanpa autentikasi). <b>Jadwal kursus yang sudah dibooking (transaksi accepted/menunggu_verifikasi) akan disembunyikan</b>. Hanya tampil jadwal yang >= hari ini, diurutkan tanggal & waktu.</span>',
        ],
        [
            'label' => 'Tambah Kursus (Khusus Mentor)',
            'method' => 'POST',
            'url' => '/api/mentor/kursus',
            'body' => [
                'namaKursus' => '',
                'deskripsi' => '',
                'gayaMengajar' => '',
                'fotoKursus' => '',
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Endpoint khusus mentor. <b>mentor_id</b> otomatis dari user login.</span>',
        ],
        [
            'label' => 'Update Kursus (Khusus Mentor)',
            'method' => 'PUT',
            'url' => '/api/mentor/kursus/{id}',
            'body' => [
                'namaKursus' => '',
                'deskripsi' => '',
                'gayaMengajar' => '',
                'fotoKursus' => '',
            ],
            'headers' => ['Authorization' => 'Bearer {token}'],
            'noteHtml' =>
                '<span class="text-xs text-amber-700">Endpoint khusus mentor. <b>mentor_id</b> otomatis dari user login.</span>',
        ],
    ],
])

@php
    $itemList = \App\Models\ItemPaket::all()->map(fn($i) => ['value' => $i->id, 'label' => $i->nama])->values();
    // Contoh body untuk POST/PUT Paket
    // Field:
    // - nama: string, nama paket
    // - harga_dasar: integer, harga asli sebelum diskon
    // - diskon: integer, nominal diskon (jika ada, frontend akan mengurangi harga_dasar)
    // - deskripsi: string, deskripsi paket
    // - max_pembelian_per_user: integer, maksimal pembelian per user
    // - tanggal_mulai: string (YYYY-MM-DD), tanggal mulai paket
    // - tanggal_berakhir: string (YYYY-MM-DD), tanggal berakhir paket
    // - items: array relasi item paket, format: [{id: item_id, jumlah_item: int}]
    // - visibilitas: array id visibilitas (opsional, jika ada relasi visibilitas)
    $defaultBody = [
        'nama' => 'Paket Percobaan 1',
        'harga_dasar' => 10000,
        'diskon' => 2000, // diskon nominal, jika 0 maka tidak ada diskon
        'deskripsi' => 'Test Demo',
        'max_pembelian_per_user' => 10,
        'tanggal_mulai' => '2025-08-03',
        'tanggal_berakhir' => '2025-08-10',
        'items' => [
            ['id' => $itemList[0]['value'] ?? '', 'jumlah_item' => 5000],
            ['id' => $itemList[1]['value'] ?? '', 'jumlah_item' => 5000],
        ],
        // 'visibilitas' => [1,2], // contoh jika ada relasi visibilitas
    ];
    $apiList = [
        [
            'label' => 'Daftar Paket',
            'method' => 'GET',
            'url' => '/api/paket',
            'note' =>
                'Ambil semua data paket beserta relasi item. Field diskon hanya ditampilkan, pengurangan harga dilakukan di frontend.',
        ],
        [
            'label' => 'Detail Paket',
            'method' => 'GET',
            'url' => '/api/paket/{id}',
            'note' =>
                'Ambil detail satu paket beserta relasi item. Field diskon hanya ditampilkan, pengurangan harga dilakukan di frontend.',
        ],
        [
            'label' => 'Tambah Paket',
            'method' => 'POST',
            'url' => '/api/paket',
            'body' => $defaultBody,
            'note' =>
                'Tambah paket baru beserta relasi item. Field diskon dikirim, harga_dasar tetap harga asli, pengurangan harga dilakukan di frontend.',
        ],
        [
            'label' => 'Update Paket',
            'method' => 'PUT',
            'url' => '/api/paket/{id}',
            'body' => $defaultBody,
            'note' =>
                'Update data paket dan relasi item. Field diskon dikirim, harga_dasar tetap harga asli, pengurangan harga dilakukan di frontend.',
        ],
        [
            'label' => 'Hapus Paket',
            'method' => 'DELETE',
            'url' => '/api/paket/{id}',
            'note' => 'Soft delete paket.',
        ],
    ];
@endphp

@include('pentest._template', [
    'title' => 'Pentest API - Paket Controller',
    'desc' => 'Halaman ini digunakan untuk menguji endpoint API Paket (CRUD dan relasi item paket).',
    'apiList' => $apiList,
])
